{% load tags %}
{% if actions %}
<div class="action-container" id="{{ target }}-{{ uuid }}-{{id}}">
    {% if request|mobile or request|tablet %}
    <div class="dropdown">
        <a class="btn btn-outline-primary dropdown-toggle {{ target }} {% if target == 'queryset' %}disabled{% endif %}" href="#" role="button" id="dropdownMenuLink"
           data-bs-toggle="dropdown" aria-expanded="false">Ações</a>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
            {% for action in actions %}
                <li>
                    <a class="dropdown-item action-button {{ target }} {% if action.modal and not request|mobile and not request|tablet %}popup{% endif %} {% if target == 'instance' and action.key not in enabled %}disabled{% endif %}"
                       href="/adm{{ action.path }}"
                       data-url="/adm{{ action.path }}"
                       data-id="{{ id }}"
                       data-uuid="{{ uuid }}">
                        {% if action.icon %}<i class="bi bi-{{ action.icon }}"></i>{% endif %}
                        {{ action.submit }}
                    </a>
                </li>
            {% endfor %}
        </ul>
    </div>
    {% else %}
        {% for action in actions %}
            {% if  target != 'instance' or  target == 'instance' and action.key in enabled %}
            <a href="/adm{{ action.path }}"
               data-url="/adm{{ action.path }}"
               data-id="{{ id }}"
               data-uuid="{{ uuid }}"
               class="action-button btn btn-outline-{{ action.style }} {{ target }} {% if target == 'queryset' %}disabled{% endif %} {% if action.modal and not request|mobile and not request|tablet %}popup{% endif %} {% if target == 'instance' and action.key not in enabled %}disabled{% endif %}">
                {% if action.icon %}<i class="bi bi-{{ action.icon }}"></i>{% endif %}
                {{ action.submit }}
            </a>
            {% endif %}
        {% endfor %}
    {% endif %}
</div>
<script>
    $('#{{ target }}-{{ uuid }}-{{id}}').find('.action-button').on('mouseenter', function(){
        if($(this).hasClass('instance')){
            this.href = $(this).data('url').replace('{id}', $(this).data('id'));
        }
        if($(this).hasClass('queryset')){
            var ids = $('#queryset-{{ uuid }}').find('.action-checkbox:checked').map(function(){
              return $(this).val();
            }).get().filter(function (id) { return id!='on' }).join('-');
            this.href = $(this).data('url').replace('{id}', ids);
        }
        if($(this).hasClass('model')){
            this.href = $(this).data('url');
        }
    });
</script>
{% endif %}


<!--<script>document.getElementById('{{ target }}-{{ uuid }}').addEventListener('show.bs.dropdown', function () { $(this).find('ul').append(''); });</script>-->